Fire Data Processor

Fire Data Processor — это набор скриптов для автоматизации скачивания, обработки и архивирования данных о пожарах с использованием данных NASA FIRMS. Скрипты предназначены для работы в среде Linux и интегрированы с системой cron для автоматического планирования выполнения задач.

Структура проекта
create_cron_job.py: Скрипт для создания одноразового cron-задания, которое запланирует выполнение dwnld_firms.py через одну минуту.
generate_cron.py: Скрипт для генерации и управления cron-заданиями на основе файла passlist. Также настраивает ежедневные и еженедельные задачи по обслуживанию, такие как очистка логов.
dwnld_firms.py: Скрипт для скачивания данных о пожарах с NASA FIRMS и запуска их последующей обработки.
process_data.py: Скрипт для обработки скачанных данных, вставки их в базу данных PostgreSQL, а также для ассоциации точек пожаров с лесными зонами.
archive_data.py: Скрипт для архивирования данных о пожарах, которые старше определенного времени, и их перемещения в архивные таблицы базы данных.

Установка и настройка

Клонируйте репозиторий:

git clone https://github.com/yourusername/fire_data_processor.git
cd fire_data_processor

Настройка окружения:

Все необходимые параметры, такие как учетные данные для базы данных и API-токен для FIRMS, должны быть указаны в переменных окружения или в файлах конфигурации (например, .env), которые не отслеживаются системой контроля версий.

Пример .env:

DB_HOST=forest_monitoring_postgis_v2
DB_NAME=geo_forestry_db
DB_USER=postgres
DB_PASSWORD=your_password_here
FIRMS_API_TOKEN=your_token_here

Соберите и запустите Docker-контейнер:

docker build -t fire_data_processor .
docker run -d fire_data_processor

Скрипты
create_cron_job.py

Назначение:

Создает одноразовое cron-задание для первого запука в контейнере, которое запустит скрипт dwnld_firms.py через одну минуту.

Использование:

python3 create_cron_job.py
generate_cron.py

Назначение:

Генерирует cron-задания на основе файла PassList.txt.
Управляет существующими cron-заданиями (обновление, удаление, добавление).
Планирует ежедневные задачи для запуска генерации новых cron-заданий и еженедельную очистку логов.

Использование:

python3 generate_cron.py
dwnld_firms.py

Назначение:

Скачивает данные о пожарах с NASA FIRMS.
После успешного скачивания данных запускает скрипт process_data.py для их обработки.

Использование:

python3 dwnld_firms.py
process_data.py

Назначение:

Обрабатывает скачанные данные, вставляет их в базу данных PostgreSQL.
Определяет, находятся ли точки пожаров в пределах Казахстана, и связывает их с лесными зонами.

Использование:

python3 process_data.py
archive_data.py

Назначение:

Архивирует данные о пожарах, старше определенного времени отсечения, перемещая их в архивные таблицы базы данных.

Использование:

python3 archive_data.py

Безопасность
Перед использованием убедитесь, что:

Все учетные данные (пароли, API-токены) вынесены в переменные окружения или файлы конфигурации.
Используйте .gitignore для исключения конфиденциальных данных из системы контроля версий.

Пример .gitignore:

# Исключаем конфиденциальные данные
*.env

# Исключаем логи и временные файлы
*.log
__pycache__/
*.pyc

# Исключаем директории с данными
/DownloadedData/
/ProcessedData/

Логи

Все скрипты ведут журнал выполнения в файле /var/log/app.log. Логи могут быть полезны для отладки и мониторинга работы скриптов.